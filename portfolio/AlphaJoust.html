<!DOCTYPE html>
<html>
	<head>
		<title>MICAH VARGAS</title>
		<meta name = "type" content = "website"/>
		<link rel="stylesheet" href="../style.css">
		<link rel="icon" type="image/png" href="../favicon.ico" sizes="16x16">
	</head>
	<body>
		<div class="header">
				<div class="left-div">
					<h1>MICAH MATEO VARGAS</h1>
					<h3>Game Developer</h3>
				</div>
				<div class="right-div">
					<div class="linked-apps">
						<a href="https://www.linkedin.com/in/micah-vargas-2b888a204/" target="_new">
							<img src="../assets/linkedin-logo.png" alt="LinkedIn Logo" width=40 height=40 title="LinkedIn Profile">
						</a>
						<a href="https://h4c1m.itch.io/" target="_new">
							<img src="../assets/itch-logo.png" alt="Itch.io Logo" width="40" height="40" title="Itch Profile">
						</a>
						<a href="mailto:micahvargas@icloud.com" target="_new">
							<img src="../assets/mail-icon.png" alt="Mail Icon" width="40" height="40" title="Mail">
						</a>
						<a href="../resume.pdf" target="_new">
							<img src="../assets/pdf-icon.png" alt="Resume Icon" width="40" height="40" title="Resume PDF">
						</a>
					</div>
				</div>
				<div class="clear"></div>
		</div>
		<div class="navbar">
			<hr>
			<div class="buttons">
				<a href="../index.html">
					<button class="text-button">
						<span>HOME</span>
					</button>
				</a>
				<a href="../portfolio.html">
					<button class="text-button">
						<span>PORTFOLIO</span>
					</button>
				</a>
				<a href="../resume.html">
					<button class="text-button">
						<span>RESUME</span>
					</button>
				</a>
				<a href="../about.html">
					<button class="text-button">
						<span>ABOUT</span>
					</button>
				</a>
			</div>
			<hr>
		</div>

		<h3>INFO</h3>
		<div class="columns">
			<div class="col">
				<p> Project Type:<br>
				Development Engine:<br>
				Programming Language:<br>
				Other Tools:<br>
				Team Size:<br>
				Role:<br>
				Duration:<br></p>
			</div>
			<div class="col">
				<p>Machine Learning<br>
				Unity<br>
				C#<br>
				Neural Networks<br>
				5<br>
				Developer<br>
				3 months<br></p>
			</div>
			<div class="col">
				<img class="icon" style="opacity: 100%; padding-left:75px; max-width:400px;" src="../assets/ss_aj.png" alt="Alpha Joust">
			</div>
		</div>
		<h3>ABOUT</h3>
		<p>
			AlphaJoust is a machine learning demo where an agent was trained to play the classic arcade game Joust using the NEAT algorithm (NeuroEvolution of Augmenting Topologies).
		</p>
		<br>
		<h3>Recreating Joust</h3>
		<p>
			A key part of the project involved recreating Joust in Unity. 
			Since our focus was on AI, our team built upon a pre-existing Joust remake, which provided a foundation while allowing us to modify and extend it. 
			We made several enhancements, including adjustments to the physics to better match the original game, which was coded in Assembly. 
			We referenced the original Assembly code to ensure accuracy and fidelity to the originals gameplay.
		</p>
		<br>
		<h3>Implementing NEAT with UnitySharpNEAT</h3>
		<p>
			For the AI training, we utilized UnitySharpNEAT, an open-source implementation of NEAT for Unity. 
			UnitySharpNEAT builds on SharpNEAT, a C# NEAT framework, providing features like object pooling, better coroutine management, and multi-experiment support. 
			This library streamlined the integration of neural networks into Unity, making it well-suited for Joust’s mechanics, which require rapid decision-making and adaptive strategies.
		</p>
		<div class="columns">
			<div class="colx2">
				<p>
					To better structure the agent's iteraction with the game environment, we designed a modular system, as shown in the UML diagram. 
					This system manages game state input, fitness evaluation, and neural network outputs efficiently.
				</p>
			</div>
			<div class="colx2">
				<img class="icon magnifiable" src="../assets/ss_aj_neat2.png" alt="UML Diagram">
			</div>
		</div>
		<br>
		<h3>How NEAT Works</h3>
		<p>
			NEAT works through three primary techniques: applying three key techniques: 
			genetic encoding, tracking genes through historical markings, and protecting innovation through speciation. 
			<br><br>
			1. Genetic Encoding: Each neural network consists of node and connection genes, whcich mutate over generations by adding new nodes, connections, and modifying weights.
		</p>
		<div class="columns">
			<div class="colx2">
				<p>
					2. Tracking Genes through Historical Markings with Innovation Numbers: 
					NEAT assigns a unique global innovation number to each new mutation, such as an added connection or node. 
					This allows the algorithm to efficiently track the evolutionary history of genes. 
					When comparing genomes, innovation numbers help determine which genes share common ancestry and which are unique, facilitating seamless crossover without requiring topological analysis. 
					This approach ensures structural compatibility between networks, allowing effective recombination of solutions.

					<br><br>
					The diagram illustrates the genome crossover process, depicting how NEAT handles disjoint and excess genes by aligning genes based on their innovation numbers. This visual representation clarifies how NEAT ensures genetic compatibility and preserves meaningful structures during evolution.
				</p>
			</div>
			<div class="colx2">
				<img class="icon magnifiable" src="../assets/ss_aj_neat.png" alt="NEAT evolution">
			</div>
		</div>
		<br>
		<p>
			3. Speciation for Innovation Protection:
			NEAT protects innovation by dividing the population into species based on topological similarity. 
			This is achieved by comparing innovation numbers to determine the degree of similarity between genomes—more disjoint genes result in lower similarity, leading to different species classifications. 
			Speciation preserves diversity by employing explicit fitness sharing, where individuals within a species share fitness values, ensuring that novel or complex structures have the opportunity to evolve without direct competition from more optimized existing solutions. 
			This mechanism played a crucial role in the Joust use case, allowing different strategies to develop and preventing premature convergence on suboptimal behaviors.
		</p>
		<br>
		<h3>Training the Agent</h3>
		<p>
			We trained the agent by using Joust's score as a fitness metric, giving us a clear representation of performance. 
			The agent received inputs for its own position and enemy positions, and produced outputs for horizontal movement and flapping. 
			By leveraging Unity's timescale adjustment, we were able to train from 1 to 10x speed on personal devices which resulted in steadily increasing scores over generations.
		</p>
		<div class="columns">
			<div class="colx2">
				<p>
					The flow chart here visually represents the evaluation process of genomes during training, making it easier to understand how fitness evaluation and evolution proceed step-by-step. 
					It outlines the sequence in which genomes are initialized, evaluated based on their performance in the game, and subsequently evolved by applying genetic operators such as mutation and crossover. 
					This structured approach ensures that the most promising solutions are iteratively refined across generations, leading to increasingly effective gameplay strategies.
				</p>
			</div>
			<div class="colx2">
				<img class="icon magnifiable" src="../assets/ss_aj_neat1.png" alt="NEAT process">
			</div>
		</div>
		<br>
		<h3>Seeing all Simulations with 'MultiCam'</h3>
		<div class="columns">
			<div class="colx2">
				<p>
					To monitor training progress, I developed a feature called MultiCam that dynamically displayed multiple simulations on screen simultaneously. 
					Each simulation had its own camera rendering to a texture, which was applied to a grid of quads. 
					I programmatically created a Camera for each instance of Joust, outputted the camera's view into a RenderTexture, placed that RenderTexture into a material, and applied that material to quads arranged in a square grid.
					While this approach had some performance cost, it allowed for quick evaluation of the agent's progress and could be toggled on or off as needed.
				</p>
			</div>
			<div class="colx2">
				<img class="icon magnifiable" src="../assets/ss_aj_multicam.png" alt="MultiCamera Array">
			</div>
		</div>
        <br><br><br><br><br><br><br>
	</body>
</html>